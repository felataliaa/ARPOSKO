<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Cinemaps WebAR</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <style>
      * {
        box-sizing: border-box;
      }
      
      body { 
        margin: 0; 
        overflow: hidden; 
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #000;
        touch-action: manipulation;
      }
      
      /* UI Controls */
      #ui {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: linear-gradient(180deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, transparent 100%);
        padding: 15px 25px;
        border-radius: 25px;
        z-index: 999;
        color: white;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        backdrop-filter: blur(5px);
        text-align: center;
      }
      
      #title {
        font-size: 20px;
        font-weight: 600;
        text-shadow: 0px 2px 8px rgba(0,0,0,0.8);
        letter-spacing: 0.5px;
      }
      
      .nav-button {
        padding: 12px;
        font-size: 24px;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        background: rgba(255, 255, 255, 0.15);
        color: white;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: fixed;
        top: 50%;
        transform: translateY(-50%);
        overflow: hidden;
      }
      
      #prevButton {
        left: 20px;
      }
      
      #nextButton {
        right: 20px;
      }
      
      .nav-button:before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s;
      }
      
      .nav-button:hover:before {
        left: 100%;
      }
      
      .nav-button:hover {
        background: rgba(255, 255, 255, 0.25);
        transform: translateY(-50%) scale(1.1);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
      }
      
      #prevButton:hover {
        transform: translateY(-50%) translateX(-2px) scale(1.1);
      }
      
      #nextButton:hover {
        transform: translateY(-50%) translateX(2px) scale(1.1);
      }
      
      .nav-button:active {
        transform: translateY(-50%) scale(0.95);
      }
      
      /* Tap to Play Overlay */
      #tapOverlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        color: white;
        text-align: center;
      }
      
      #tapOverlay.hidden {
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.5s ease;
      }
      
      .tap-instruction {
        font-size: 24px;
        font-weight: 600;
        margin-bottom: 20px;
        text-shadow: 0 2px 10px rgba(0,0,0,0.8);
        animation: pulse 2s infinite;
      }
      
      .tap-icon {
        font-size: 80px;
        margin-bottom: 30px;
        animation: bounce 2s infinite;
        filter: drop-shadow(0 4px 8px rgba(0,0,0,0.5));
      }
      
      .subtitle {
        font-size: 16px;
        opacity: 0.8;
        margin-top: 10px;
      }
      
      @keyframes pulse {
        0%, 100% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.05); opacity: 0.8; }
      }
      
      @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-20px); }
        60% { transform: translateY(-10px); }
      }
      
      /* Video Info Panel */
      #videoInfo {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 15px 25px;
        border-radius: 25px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        text-align: center;
        opacity: 0;
        transition: all 0.3s ease;
        z-index: 998;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      }
      
      #videoInfo.show {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
      
      .video-counter {
        font-size: 14px;
        opacity: 0.8;
        margin-top: 5px;
      }
      
      /* Mobile Optimizations */
      @media (max-width: 768px) {
        #ui {
          padding: 12px 20px;
        }
        
        #title {
          font-size: 18px;
        }
        
        .nav-button {
          width: 55px;
          height: 55px;
          font-size: 20px;
          padding: 10px;
        }
        
        #prevButton {
          left: 15px;
        }
        
        #nextButton {
          right: 15px;
        }
        
        .tap-instruction {
          font-size: 20px;
          padding: 0 20px;
        }
        
        .tap-icon {
          font-size: 60px;
        }
        
        #videoInfo {
          bottom: 15px;
          padding: 12px 20px;
          max-width: calc(100% - 30px);
        }
      }
      
      @media (max-width: 480px) {
        #ui {
          padding: 10px 15px;
        }
        
        #title {
          font-size: 16px;
        }
        
        .nav-button {
          width: 50px;
          height: 50px;
          font-size: 18px;
          padding: 8px;
        }
        
        #prevButton {
          left: 10px;
        }
        
        #nextButton {
          right: 10px;
        }
        
        .tap-instruction {
          font-size: 18px;
        }
        
        .tap-icon {
          font-size: 50px;
        }
        
        #videoInfo {
          padding: 10px 18px;
          font-size: 14px;
        }
      }
      
      /* Landscape mode adjustments */
      @media (orientation: landscape) and (max-height: 500px) {
        #ui {
          padding: 8px 15px;
        }
        
        #title {
          font-size: 16px;
        }
        
        .nav-button {
          width: 45px;
          height: 45px;
          font-size: 16px;
        }
        
        #prevButton {
          left: 8px;
        }
        
        #nextButton {
          right: 8px;
        }
        
        .tap-instruction {
          font-size: 20px;
        }
        
        .tap-icon {
          font-size: 40px;
          margin-bottom: 15px;
        }
        
        #videoInfo {
          bottom: 10px;
          padding: 8px 15px;
          font-size: 13px;
        }
      }
      
      /* Loading animation for video plane */
      @keyframes fadeIn {
        from { opacity: 0; transform: scale(0.8); }
        to { opacity: 1; transform: scale(1); }
      }
      
      .video-loaded {
        animation: fadeIn 0.5s ease-out;
      }
    </style>
  </head>
  <body>
    <!-- Tap to Play Overlay -->
    <div id="tapOverlay">
      <div class="tap-icon">üì±</div>
      <div class="tap-instruction">Tap layar untuk memulai video</div>
    </div>
    
    <!-- UI Controls -->
    <div id="ui">
      <div id="title">Posko KKN</div>
    </div>
    
    <!-- Navigation Buttons -->
    <button id="prevButton" class="nav-button" onclick="prevVideo()" title="Video Sebelumnya">‚èÆÔ∏è</button>
    <button id="nextButton" class="nav-button" onclick="nextVideo()" title="Video Selanjutnya">‚è≠Ô∏è</button>
    
    <!-- Video Info Panel -->
    <div id="videoInfo">
      <div id="videoTitle">Posko KKN</div>
      <div class="video-counter" id="videoCounter">1 / 4</div>
    </div>
    
    <!-- AR Scene -->
    <a-scene
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false; trackingMethod: best;"
      vr-mode-ui="enabled: false"
      renderer="logarithmicDepthBuffer: true; antialias: true; colorManagement: true;"
      loading-screen="enabled: false">
     
      <!-- Kamera -->
      <a-camera position="0 0.5 0" look-controls="enabled: true"></a-camera>
      
      <!-- Plane tempat video (awalnya tersembunyi) -->
      <a-plane 
        id="videoPlane" 
        position="0 0 -10" 
        rotation="0 0 0" 
        width="4" 
        height="2.25" 
        material="shader: flat; src: #vid1; opacity: 0;"
        visible="false">
      </a-plane>
      
      <!-- Asset Videos -->
      <a-assets>
        <video id="vid1" 
               src="asset/POSKO.mp4" 
               loop="true" 
               muted 
               playsinline 
               crossorigin="anonymous"
               preload="metadata"></video>
        <video id="vid2" 
               src="asset/Joglo.mov" 
               loop="true" 
               muted 
               playsinline 
               crossorigin="anonymous"
               preload="metadata"></video>
        <video id="vid3" 
               src="asset/Plunyon.mov" 
               loop="true" 
               muted 
               playsinline 
               crossorigin="anonymous"
               preload="metadata"></video>
        <video id="vid4" 
               src="asset/Batukapal.mov" 
               loop="true" 
               muted 
               playsinline 
               crossorigin="anonymous"
               preload="metadata"></video>
      </a-assets>
    </a-scene>

    <script>
      const videos = [
        { id: "#vid1", title: "Posko KKN" },
        { id: "#vid2", title: "Joglo Wanagama" },
        { id: "#vid3", title: "Batu Kapal" },
        { id: "#vid4", title: "Jembatan Plunyon" }
      ];
      
      let currentIndex = 0;
      let videoStarted = false;
      
      const plane = document.getElementById("videoPlane");
      const title = document.getElementById("title");
      const videoInfo = document.getElementById("videoInfo");
      const videoTitle = document.getElementById("videoTitle");
      const videoCounter = document.getElementById("videoCounter");
      const tapOverlay = document.getElementById("tapOverlay");
      
      // Function to start video on first tap
      function startVideo() {
        if (videoStarted) return;
        
        videoStarted = true;
        tapOverlay.classList.add("hidden");
        
        // Show video plane
        plane.setAttribute("visible", "true");
        plane.setAttribute("material", "opacity", "1");
        plane.classList.add("video-loaded");
        
        // Show video info
        setTimeout(() => {
          videoInfo.classList.add("show");
        }, 500);
        
        // Start all videos
        videos.forEach(v => {
          const videoEl = document.querySelector(v.id);
          videoEl.play().catch(e => console.log("Video play error:", e));
        });
        
        updateVideo();
      }
      
      // Function to update video
      function updateVideo() {
        if (!videoStarted) return;
        
        const v = videos[currentIndex];
        plane.setAttribute("material", "src", v.id);
        title.innerText = v.title;
        videoTitle.innerText = v.title;
        videoCounter.innerText = `${currentIndex + 1} / ${videos.length}`;
        
        // Play current video
        const videoEl = document.querySelector(v.id);
        videoEl.currentTime = 0; // Reset to beginning
        videoEl.play().catch(e => console.log("Video play error:", e));
        
        // Animate video info update
        videoInfo.style.transform = "translateX(-50%) translateY(10px)";
        videoInfo.style.opacity = "0.7";
        setTimeout(() => {
          videoInfo.style.transform = "translateX(-50%) translateY(0)";
          videoInfo.style.opacity = "1";
        }, 150);
      }
      
      // Navigation functions
      function nextVideo() {
        if (!videoStarted) {
          startVideo();
          return;
        }
        currentIndex = (currentIndex + 1) % videos.length;
        updateVideo();
      }
      
      function prevVideo() {
        if (!videoStarted) {
          startVideo();
          return;
        }
        currentIndex = (currentIndex - 1 + videos.length) % videos.length;
        updateVideo();
      }
      
      // Event listeners
      document.body.addEventListener("click", startVideo);
      document.body.addEventListener("touchstart", startVideo);
      
      // Prevent context menu on long press (mobile)
      document.addEventListener("contextmenu", (e) => e.preventDefault());
      
      // Handle orientation change
      window.addEventListener("orientationchange", () => {
        setTimeout(() => {
          // Refresh video if needed
          if (videoStarted) {
            const videoEl = document.querySelector(videos[currentIndex].id);
            videoEl.play().catch(e => console.log("Video play error:", e));
          }
        }, 100);
      });
      
      // Initialize
      document.addEventListener("DOMContentLoaded", () => {
        // Set initial video counter
        videoCounter.innerText = `1 / ${videos.length}`;
      });
      
      // Handle video errors
      videos.forEach((v, index) => {
        const videoEl = document.querySelector(v.id);
        videoEl.addEventListener("error", (e) => {
          console.error(`Error loading video ${index + 1}:`, e);
        });
        
        videoEl.addEventListener("loadeddata", () => {
          console.log(`Video ${index + 1} loaded successfully`);
        });
      });
    </script>
  </body>
</html>